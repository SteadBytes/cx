#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\usepackage[bookmarksnumbered=true,bookmarksopen=true,colorlinks=true,citecolor=blue,urlcolor=blue]{hyperref}
\usepackage{tocbibind}
\usepackage{url}
\usepackage{etoolbox}
\usepackage{draftwatermark}

\input{version.tex}

\newcommand{\cxDate}{
  \ifdefempty{\cxVersion}{
    \textbf{Draft}\space:\space\today
  }{
    Version\space\cxVersion\space:\space\today
  }
}

\SetWatermarkLightness{0.9}
\SetWatermarkScale{5}
\ifdefempty{\cxVersion}{
  \SetWatermarkText{DRAFT}
}{
  \SetWatermarkText{}
}
\end_preamble
\use_default_options true
\begin_modules
customHeadersFooters
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family sfdefault
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 1
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 2cm
\topmargin 2cm
\rightmargin 2cm
\bottommargin 2cm
\secnumdepth 4
\tocdepth 4
\paragraph_separation skip
\defskip medskip
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle fancy
\listings_params "style=colorful,fontsize={\small},samepage=true"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
CX: An architecture for privacy-compatible
\begin_inset Newline newline
\end_inset

distributed contact tracing
\end_layout

\begin_layout Author

\family typewriter
Michael Brown <
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
href{mailto:mcb30@ipxe.org}{mcb30@ipxe.org}
\end_layout

\end_inset

>
\end_layout

\begin_layout Date
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cxDate
\end_layout

\end_inset


\end_layout

\begin_layout Left Header
CX: An architecture for privacy-compatible distributed contact tracing
\end_layout

\begin_layout Center Header

\end_layout

\begin_layout Right Header
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cxDate
\end_layout

\end_inset


\end_layout

\begin_layout Left Footer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
leftmark
\end_layout

\end_inset


\end_layout

\begin_layout Center Footer

\end_layout

\begin_layout Right Footer
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
thepage
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Section
Overview
\begin_inset CommandInset label
LatexCommand label
name "sec:Overview"

\end_inset


\end_layout

\begin_layout Section
Terminology
\begin_inset CommandInset label
LatexCommand label
name "sec:Terminology"

\end_inset


\end_layout

\begin_layout Standard
The key words 
\begin_inset Quotes eld
\end_inset

MUST
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

MUST NOT
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

REQUIRED
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

SHALL
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

SHALL NOT
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

SHOULD
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

SHOULD NOT
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

RECOMMENDED
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

MAY
\begin_inset Quotes erd
\end_inset

, and 
\begin_inset Quotes eld
\end_inset

OPTIONAL
\begin_inset Quotes erd
\end_inset

 in this document are to be interpreted as described in RFC
\begin_inset space ~
\end_inset

2119
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC2119"
literal "false"

\end_inset

.
\end_layout

\begin_layout Description
Advertisement: A message broadcast by an 
\series bold
Advertiser
\series default
 containing a single 
\series bold
Contact Identifier
\series default
.
\end_layout

\begin_layout Description
Advertiser: The role played by a 
\series bold
Device
\series default
 in which it regularly broadcasts 
\series bold
Advertisements
\series default
 that may be received by other devices in their role as 
\series bold
Observers
\series default
.
\end_layout

\begin_layout Description
Alert
\begin_inset space ~
\end_inset

Level: A label that may be retroactively associated with a 
\series bold
Contact
\series default
 indicating a potential hazard presented by an 
\series bold
Advertiser
\series default
 to any 
\series bold
Observers
\series default
.
\end_layout

\begin_layout Description
Contact: A receipt of an 
\series bold
Advertisement
\series default
 by an 
\series bold
Observer
\series default
, indicating that the 
\series bold
Advertiser
\series default
 and 
\series bold
Observer
\series default
 are in close physical proximity.
\end_layout

\begin_layout Description
Contact
\begin_inset space ~
\end_inset

Alert: A 
\series bold
Contact
\series default
 within an 
\series bold
Observer's
\series default
 recorded history of received 
\series bold
Contact Identifiers
\series default
 that is subsequently associated with an 
\series bold
Alert Level
\series default
.
\end_layout

\begin_layout Description
Contact
\begin_inset space ~
\end_inset

Identifier: An RFC
\begin_inset space ~
\end_inset

4122
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC4122"
literal "false"

\end_inset

 version
\begin_inset space ~
\end_inset

4 pseudo-random UUID generated using a 
\series bold
Generator
\series default
 and broadcast as part of an 
\series bold
Advertisement
\series default
.
\end_layout

\begin_layout Description
Device: An entity (such as a mobile phone) capable of simultaneously acting
 as both an 
\series bold
Advertiser
\series default
 and an 
\series bold
Observer
\series default
.
\end_layout

\begin_layout Description
DRBG: A Deterministic Random Bit Generator as defined by NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

.
\end_layout

\begin_layout Description
Generator: An algorithm as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Algorithms"
plural "false"
caps "false"
noprefix "false"

\end_inset

 used to generate 
\series bold
Contact Identifiers
\series default
.
\end_layout

\begin_layout Description
Generator
\begin_inset space ~
\end_inset

Type: An integer value as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

 used as an input to a 
\series bold
Generator.
\end_layout

\begin_layout Description
Notification: A tuple comprising an 
\series bold
Alert Level
\series default
, a 
\series bold
Generator Type
\series default
 and a 
\series bold
Seed Value
\series default
 that appears within a 
\series bold
Publication
\series default
 and is used by an 
\series bold
Observer
\series default
 to identify 
\series bold
Contact Alerts
\series default
.
\end_layout

\begin_layout Description

\series bold
Observer:
\series default
 The role played by a 
\series bold
Device
\series default
 in which it listens for 
\series bold
Advertisements
\series default
 broadcast by other 
\series bold
Devices
\series default
 in their role as 
\series bold
Advertisers
\series default
 and records the received 
\series bold
Contact Identifiers
\series default
.
\end_layout

\begin_layout Description
Preseed
\begin_inset space ~
\end_inset

Key
\begin_inset space ~
\end_inset

Pair: An asymmetric key pair comprising a 
\series bold
Preseed Signing Key
\series default
 and a 
\series bold
Preseed Verification Key
\series default
.
\end_layout

\begin_layout Description
Preseed
\begin_inset space ~
\end_inset

Signing
\begin_inset space ~
\end_inset

Key: The private key component of a 
\series bold
Preseed Key Pair
\series default
 used to prove authorship of a 
\series bold
Seed Report
\series default
.
\end_layout

\begin_layout Description
Preseed
\begin_inset space ~
\end_inset

Value: A sequence of pseudorandom bytes used in conjunction with a 
\series bold
Preseed Verification Key
\series default
 to construct a 
\series bold
Seed Value
\series default
.
\end_layout

\begin_layout Description
Preseed
\begin_inset space ~
\end_inset

Verification
\begin_inset space ~
\end_inset

Key: The public key component of a 
\series bold
Preseed Key Pair
\series default
 used in conjunction with a 
\series bold
Preseed Value
\series default
 to construct a 
\series bold
Seed Value
\series default
.
\end_layout

\begin_layout Description
Publication: A set of 
\series bold
Notifications
\series default
 signed using a 
\series bold
Publisher Certificate 
\series default
that are made available for download by any interested 
\series bold
Observers
\series default
.
\end_layout

\begin_layout Description
Publisher: An entity (such as a national health authority) that provides
 a source of 
\series bold
Publications
\series default
.
\end_layout

\begin_layout Description
Publisher
\begin_inset space ~
\end_inset

Certificate: An X.509
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5280"
literal "false"

\end_inset

 certificate identifing a 
\series bold
Publisher
\series default
.
\end_layout

\begin_layout Description
Publisher
\begin_inset space ~
\end_inset

Name: An arbitrary human-readable name used to informally disambiguate between
 
\series bold
Publishers
\series default
.
\end_layout

\begin_layout Description
Publisher
\begin_inset space ~
\end_inset

Private
\begin_inset space ~
\end_inset

Key: The private key corresponding to a 
\series bold
Publisher Certificate
\series default
 used to prove authorship of a 
\series bold
Publication
\series default
.
\end_layout

\begin_layout Description
Seed
\begin_inset space ~
\end_inset

Calculator: An algorithm as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Calculator-Algorithms"
plural "false"
caps "false"
noprefix "false"

\end_inset

 used to construct 
\series bold
Seed Values
\series default
.
\end_layout

\begin_layout Description
Seed
\begin_inset space ~
\end_inset

Report: A tuple comprising a 
\series bold
Generator Type
\series default
, a 
\series bold
Preseed Value
\series default
, a 
\series bold
Preseed Verification Key
\series default
, and a 
\series bold
Seed Report Challenge 
\series default
that is signed using a 
\series bold
Preseed Signing Key
\series default
 and uploaded to a 
\series bold
Publisher
\series default
.
\end_layout

\begin_layout Description
Seed
\begin_inset space ~
\end_inset

Report
\begin_inset space ~
\end_inset

Challenge: A sequence of pseudorandom text characters that is generated
 by a 
\series bold
Publisher
\series default
 and signed using a 
\series bold
Preseed Signing Key 
\series default
as part of a 
\series bold
Seed Report
\series default
.
\end_layout

\begin_layout Description
Seed
\begin_inset space ~
\end_inset

Value: A sequence of pseudorandom bytes used as an input to a 
\series bold
Generator
\series default
.
 
\end_layout

\begin_layout Section
Generators
\begin_inset CommandInset label
LatexCommand label
name "sec:Generators"

\end_inset


\end_layout

\begin_layout Standard
A Generator is used to construct a sequence of Contact Identifiers.
 The values of the Contact Identifiers are RFC
\begin_inset space ~
\end_inset

4122
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC4122"
literal "false"

\end_inset

 version
\begin_inset space ~
\end_inset

4 pseudo-random UUIDs.
\end_layout

\begin_layout Standard
If the Seed Value used to create a Generator is not known, then the 122
 non–fixed bits of each 128-bit UUID form a bitstring that is indistinguishable
 from an ideal random bitstring up to a security strength as specified in
 section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generator-Sample-Code"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for a Generator using the standard OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
 Generator implementations MUST produce a sequence of Contact Identifiers
 matching the test vectors given in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generator-Test-Vectors"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Generator Types
\begin_inset CommandInset label
LatexCommand label
name "subsec:Generator-Types"

\end_inset


\end_layout

\begin_layout Standard
The following Generator Type values are defined:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="7">
<features tabularvalignment="middle">
<column alignment="center" valignment="middle" width="10text%">
<column alignment="center" valignment="middle" width="20text%">
<column alignment="center" valignment="middle" width="10text%">
<column alignment="center" valignment="middle" width="10text%">
<column alignment="center" valignment="middle" width="10text%">
<column alignment="center" valignment="middle" width="10text%">
<column alignment="center" valignment="middle" width="10text%">
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DRBG Mechanism
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Security Strength (bits)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Seed Length (bytes) 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Entropy Input Length (bytes)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Nonce Length (bytes)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Maximum Iterations
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CTR_DRBG using AES-128 with DF
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
128
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2048
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CTR_DRBG using AES-256 with DF
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
256
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
48
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
32
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2048
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
All other Generator Type values are reserved for future use.
\end_layout

\begin_layout Standard
Advertisers SHOULD choose to use Generator Type 1 when generating Contact
 Identifiers for inclusion in Advertisements.
\end_layout

\begin_layout Standard
Observers MUST support all defined Generator Types when processing Notifications
 to identify Contact Alerts.
 Observers MUST accept a Notification containing a Generator Type that they
 do not recognise.
 Observers SHOULD warn the user and provide a facility for resolving the
 unrecognised Generator Type (e.g.
\begin_inset space ~
\end_inset

by updating to a newer version of the software and reprocessing the Notification
).
\end_layout

\begin_layout Standard
For all Generator Types, the Seed Length SHALL be equal to the sum of the
 Entropy Input Length and the Nonce Length.
\end_layout

\begin_layout Standard
The underlying DRBG mechanisms are defined by NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 and MUST be used as specified in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Algorithms"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Generator Algorithms
\begin_inset CommandInset label
LatexCommand label
name "subsec:Generator-Algorithms"

\end_inset


\end_layout

\begin_layout Standard
An Advertiser SHALL use the algorithm defined in this section to generate
 a sequence of Contact Identifiers for inclusion in Advertisements.
\end_layout

\begin_layout Standard
An Observer SHALL use the algorithm defined in this section to regenerate
 the sequence of Contact Identifiers corresponding to a Notification.
\end_layout

\begin_layout Standard
A Publisher has no need for the algorithm defined in this section since
 Contact Identifiers do not appear directly in Notifications.
\end_layout

\begin_layout Standard
The algorithm comprises three steps:
\end_layout

\begin_layout Enumerate
Instantiate the Generator using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Instantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Iterate over the Generator using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Iteration"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Uninstantiate the Generator using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Uninstantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Generator State
\begin_inset CommandInset label
LatexCommand label
name "subsec:Generator-State"

\end_inset


\end_layout

\begin_layout Standard
The state of a Generator comprises:
\end_layout

\begin_layout Itemize
A Generator Iteration Counter.
\end_layout

\begin_layout Itemize
A Generator DRBG instantiated using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Instantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Generator Instantiation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Generator-Instantiation"

\end_inset


\end_layout

\begin_layout Standard
The input required to instantiate a Generator comprises:
\end_layout

\begin_layout Itemize
A Generator Type as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
A Seed Value of the Seed Length specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
A Generator SHALL initialise the Generator Iteration Counter to zero.
\end_layout

\begin_layout Standard
A Generator SHALL instantiate a Generator DRBG using functionality equivalent
 to the 
\series bold
Instantiate_function
\series default
 as defined in NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 section
\begin_inset space ~
\end_inset

9.1 with the following parameters:
\end_layout

\begin_layout Itemize
The DRBG mechanism SHALL be the DRBG Mechanism specified for the Generator
 Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
requested_instantiation_security_strength
\emph default
 SHALL be set to the Security Strength specified for the Generator Type
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
prediction_resistance_flag
\emph default
 SHALL be set to False.
\end_layout

\begin_layout Itemize
The 
\emph on
personalization_string
\emph default
 SHALL be omitted.
\end_layout

\begin_layout Itemize
The 
\emph on
entropy_input
\emph default
 value returned by the 
\series bold
Get_entropy_input
\series default
 function SHALL be the first N bytes of the Seed Value, where N is the Entropy
 Input Length specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
nonce
\emph default
 value SHALL be the last M bytes of the Seed Value, where M is the Nonce
 Length specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Note that this algorithm violates the wording of NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 that for 
\emph on
entropy_input
\emph default
 and 
\emph on
nonce
\emph default
:
\end_layout

\begin_layout Quote
\begin_inset Quotes eld
\end_inset

This information 
\series bold
shall not
\series default
 be provided by the consuming application as an input parameter during the
 instantiate request
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This violation is REQUIRED in order to allow an Observer to reconstruct
 a sequence of Contact Identifiers previously broadcast by an Advertiser,
 where the Advertiser has intentionally chosen to publish the Seed Value
 by means of a Seed Report for inclusion in a Notification.
\end_layout

\begin_layout Standard
An Advertiser MUST construct new Seed Values using the algorithm defined
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Calculators"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generator-Sample-Code"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for Generator instantiation using the standard OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
\end_layout

\begin_layout Subsubsection
Generator Iteration
\begin_inset CommandInset label
LatexCommand label
name "subsec:Generator-Iteration"

\end_inset


\end_layout

\begin_layout Standard
A Generator SHALL generate the next Contact Identifier in a sequence as
 follows:
\end_layout

\begin_layout Itemize
If the Generator Iteration Counter has reached the Maximum Iterations specified
 for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

 then return with an error indicating that the Generator is exhausted.
\end_layout

\begin_layout Itemize
Increment the Generator Iteration Counter by one.
\end_layout

\begin_layout Itemize
Generate the next 16 bytes (128 bits) of pseudorandom bits from the Generator
 DRBG using functionality equivalent to the 
\series bold
Generate_function
\series default
 as defined in NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 section
\begin_inset space ~
\end_inset

9.3.1 with the following parameters:
\end_layout

\begin_deeper
\begin_layout Itemize
The 
\emph on
state_handle
\emph default
 SHALL be set to the 
\emph on
state_handle
\emph default
 returned by the call to 
\series bold
Instantiate_function
\series default
 from section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Instantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
requested_number_of_bits
\emph default
 SHALL be set to 128.
\end_layout

\begin_layout Itemize
The 
\emph on
requested_security_strength
\emph default
 SHALL be set to the Security Strength specified for the Generator Type
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
prediction_resistance_request
\emph default
 flag SHALL be set to False.
\end_layout

\begin_layout Itemize
The 
\emph on
additional_input
\emph default
 SHALL be omitted.
\end_layout

\end_deeper
\begin_layout Itemize
Treat the 16 bytes of pseudorandom bits as a UUID with all fields in network
 byte order as defined by RFC
\begin_inset space ~
\end_inset

4122
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC4122"
literal "false"

\end_inset

.
\end_layout

\begin_layout Itemize
Set the fixed bits that are required for a version
\begin_inset space ~
\end_inset

4 UUID as specified in RFC
\begin_inset space ~
\end_inset

4122
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC4122"
literal "false"

\end_inset

 section
\begin_inset space ~
\end_inset

4.4:
\end_layout

\begin_deeper
\begin_layout Itemize
Set the two most significant bits (bits 7 and 6) of the 
\emph on
clock_seq_hi_and_reserved
\emph default
 to the binary value 10.
\end_layout

\begin_layout Itemize
Set the four most significant bits (bits 15 through 12) of the 
\emph on
time_hi_and_version
\emph default
 field to the binary value 0100.
\end_layout

\begin_layout Itemize
Leave all other bits unaltered from the pseudorandom bits produced by the
 call to 
\series bold
Generate_function
\series default
.
\end_layout

\end_deeper
\begin_layout Itemize
Return this UUID as the next Contact Identifier.
\end_layout

\begin_layout Standard
A Generator MUST NOT use the Generator DRBG for any purpose other than generatin
g Contact Identifiers using the algorithm defined in this section.
\end_layout

\begin_layout Standard
A Generator MUST limit the total cumulative number of iterations since instantia
tion to not exceed the Maximum Iterations specified for the Generator Type
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generator-Sample-Code"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for Generator iteration using the standard OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
\end_layout

\begin_layout Subsubsection
Generator Uninstantiation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Generator-Uninstantiation"

\end_inset


\end_layout

\begin_layout Standard
A Generator SHALL uninstantiate the DRBG using functionality equivalent
 to the 
\series bold
Uninstantiate_function
\series default
 as defined in NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 section
\begin_inset space ~
\end_inset

9.4.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Generator-Sample-Code"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for Generator uninstantiation using the standard OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
\end_layout

\begin_layout Section
Seed Calculators
\begin_inset CommandInset label
LatexCommand label
name "sec:Seed-Calculators"

\end_inset


\end_layout

\begin_layout Standard
A Seed Calculator is used to construct a Seed Value.
 The Seed Value is used as the initial input to a Generator, which is then
 used to construct a sequence of Contact Identifiers.
\end_layout

\begin_layout Standard
A Seed Value is constructed from a Preseed Value and a Preseed Verification
 Key.
 If the Preseed Value and Preseed Verification Key are not known, then the
 Seed Value is indistinguishable from an ideal random bitstring up to a
 security strength as specified in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Calculator-Sample"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for a Seed Calculator using the standard OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
 Seed Calculator implementations MUST produce Seed Values matching the test
 vectors given in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Calculator-Test"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Seed Calculator Algorithms
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Calculator-Algorithms"

\end_inset


\end_layout

\begin_layout Standard
An Advertiser SHALL use the algorithm defined in this section to construct
 a Seed Value for instantiating a Generator.
\end_layout

\begin_layout Standard
A Publisher SHALL use the algorithm defined in this section to construct
 a Seed Value for inclusion in a Notification.
\end_layout

\begin_layout Standard
An Observer has no need for the algorithm defined in this section, since
 the constructed Seed Value is already present in the Notification and is
 signed by the Pubisher Certificate.
\end_layout

\begin_layout Standard
The algorithm comprises three steps:
\end_layout

\begin_layout Enumerate
Instantiate the Seed Calculator using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Calculator-Instantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Construct the Seed Value using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Calculator-Generation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Uninstantiate the Seed Calculator using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Calculator-Uninstantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
In the terminology of NIST
\begin_inset space ~
\end_inset

SP800-90C
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90C"
literal "false"

\end_inset

 section 10.1.1, the combination of a Seed Calculator and a Generator produces
 an Approved construction in which the Seed Calculator is used as the source
 DRBG and the Generator is used as the target DRBG.
\end_layout

\begin_layout Subsubsection
Seed Calculator State
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Calculator-State"

\end_inset


\end_layout

\begin_layout Standard
The state of a Seed Calculator comprises:
\end_layout

\begin_layout Itemize
A Seed Calculator DRBG instantiated using the algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Calculator-Instantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Seed Calculator Instantiation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Calculator-Instantiation"

\end_inset


\end_layout

\begin_layout Standard
The input required to instantiate a Seed Calculator comprises:
\end_layout

\begin_layout Itemize
A Generator Type as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
A Preseed Value of the Seed Length specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
A Preseed Verification Key.
\end_layout

\begin_layout Standard
A Seed Calculator SHALL instantiate a Seed Calculator DRBG using functionality
 equivalent to the 
\series bold
Instantiate_function
\series default
 as defined in NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 section 9.1 with the following parameters:
\end_layout

\begin_layout Itemize
The DRBG mechanism SHALL be the DRBG Mechanism specified for the Generator
 Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
requested_instantiation_security_strength
\emph default
 SHALL be set to the Security Strength specified for the Generator Type
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
prediction_resistance_flag
\emph default
 SHALL be set to False.
\end_layout

\begin_layout Itemize
The 
\emph on
personalization_string
\emph default
 SHALL be set to the Preseed Verification Key encoded using the ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoding of the 
\series bold
SubjectPublicKeyInfo
\series default
 field as defined by X.509
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5280"
literal "false"

\end_inset

 section
\begin_inset space ~
\end_inset

4.1.
\end_layout

\begin_layout Itemize
The 
\emph on
entropy_input
\emph default
 value returned by the 
\series bold
Get_entropy_input
\series default
 function SHALL be the first N bytes of the Preseed Value, where N is the
 Entropy Input Length specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
nonce
\emph default
 value SHALL be the last M bytes of the Preseed Value, where M is the Nonce
 Length specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Note that this algorithm violates the wording of NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 that for 
\emph on
entropy_input
\emph default
 and 
\emph on
nonce
\emph default
:
\end_layout

\begin_layout Quote
\begin_inset Quotes eld
\end_inset

This information 
\series bold
shall not
\series default
 be provided by the consuming application as an input parameter during the
 instantiate request
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This violation is REQUIRED in order to allow a Publisher to reconstruct
 a Seed Value, where the Advertiser has intentionally chosen to publish
 the Preseed Value by means of a Seed Report for inclusion of the resulting
 Seed Value in a Notification.
\end_layout

\begin_layout Standard
An Advertiser MUST construct the Preseed Value using an RBG that is known
 to have a security strength equal to or greater than the security strength
 specified for the Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Calculator-Sample"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for Seed Calculator instantiation using the standard
 OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
\end_layout

\begin_layout Paragraph*
Caveat
\end_layout

\begin_layout Standard
Note that the definition of the 
\series bold
SubjectPublicKeyInfo
\series default
 field in X.509
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5280"
literal "false"

\end_inset

 allows for some freedom of choice in representation.
 For example, when the 
\series bold
algorithmIdentifier
\series default
 field requires no parameters, some implementations will choose to set the
 
\series bold
parameters
\series default
 field to an explicit ASN.1 NULL, while some implementations will choose
 to simply omit the 
\series bold
parameters
\series default
 field.
\end_layout

\begin_layout Standard
It is REQUIRED that any such implementation choices are made consistently
 for any given Preseed Verification Key, since any variation in the encoded
 Preseed Verification Key will result in the construction of an incorrect
 Seed Value.
\end_layout

\begin_layout Standard
Advertisers MAY choose any valid ASN.1
\begin_inset space ~
\end_inset

DER encoding of 
\series bold
SubjectPublicKeyInfo
\series default
.
 Advertisers MUST choose this same encoding of 
\series bold
SubjectPublicKeyInfo
\series default
 for all uses of the Preseed Verification Key, including when constructing
 a Seed Report.
\end_layout

\begin_layout Standard
Publishers MUST use the ASN.1
\begin_inset space ~
\end_inset

DER encoding exactly as presented in the Seed Report.
\end_layout

\begin_layout Subsubsection
Seed Calculator Generation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Calculator-Generation"

\end_inset


\end_layout

\begin_layout Standard
A Seed Calculator SHALL generate the Seed Value as follows:
\end_layout

\begin_layout Itemize
Generate pseudorandom bits from the Seed Calculator DRBG using functionality
 equivalent to the 
\series bold
Generate_function
\series default
 as defined in NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 section
\begin_inset space ~
\end_inset

9.3.1 with the following parameters:
\end_layout

\begin_deeper
\begin_layout Itemize
The 
\emph on
state_handle
\emph default
 SHALL be set to the 
\emph on
state_handle
\emph default
 returned by the call to 
\series bold
Instantiate_function
\series default
 from section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Calculator-Instantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
requested_number_of_bits
\emph default
 SHALL be set to the number of bits in the Seed Length specified for the
 Generator Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 (Note that the Seed Length is specified as a number of bytes.)
\end_layout

\begin_layout Itemize
The 
\emph on
requested_security_strength
\emph default
 SHALL be set to the Security Strength specified for the Generator Type
 in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Itemize
The 
\emph on
prediction_resistance_request
\emph default
 flag SHALL be set to False.
\end_layout

\begin_layout Itemize
The 
\emph on
additional_input
\emph default
 SHALL be omitted.
\end_layout

\end_deeper
\begin_layout Itemize
Return these bytes as the Seed Value.
\end_layout

\begin_layout Standard
A Seed Calculator MUST NOT use the Seed Calculator DRBG for any purpose
 other than generating the Seed Value using the algorithm defined in this
 section.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Calculator-Sample"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for Seed Calculator generation using the standard
 OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
\end_layout

\begin_layout Subsubsection
Seed Calculator Uninstantiation
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Calculator-Uninstantiation"

\end_inset


\end_layout

\begin_layout Standard
A Seed Calculator SHALL uninstantiate the DRBG using functionality equivalent
 to the 
\series bold
Uninstantiate_function
\series default
 as defined in NIST
\begin_inset space ~
\end_inset

SP800-90A
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "SP800-90A"
literal "false"

\end_inset

 section
\begin_inset space ~
\end_inset

9.4.
\end_layout

\begin_layout Standard
Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Seed-Calculator-Sample"
plural "false"
caps "false"
noprefix "false"

\end_inset

 provides sample code for Seed Calculator uninstantiation using the standard
 OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library.
\end_layout

\begin_layout Section
Seed Reports
\begin_inset CommandInset label
LatexCommand label
name "sec:Seed-Reports"

\end_inset


\end_layout

\begin_layout Standard
A Seed Report is a message constructed by an Advertiser to be sent to a
 Publisher.
 The Seed Report is used to verify original authorship of a set of Seed
 Values and to associate the Seed Values with an Alert Level for inclusion
 into a Notification.
\end_layout

\begin_layout Standard
Note that the Seed Report does not directly convey an Alert Level; see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Challenges"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Seed Report Challenges
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Report-Challenges"

\end_inset


\end_layout

\begin_layout Standard
The association between the Seed Values and the Alert Level is conveyed
 using a Seed Report Challenge.
 The Seed Report Challenge is a single-use short-lived authorisation code
 provided by the Publisher to the Advertiser through an out-of-band mechanism.
\end_layout

\begin_layout Standard
For example: a national health authority (a Publisher) could provide its
 practitioners with the ability to record a positive diagnosis of a patient
 into the health authority's existing systems.
 The health authority could then generate a 16-digit PIN code (the Seed
 Report Challenge) which is associated in the health authority's database
 with the positive diagnosis.
 The 16-digit PIN code is given by the practitioner to the patient, who
 enters it into the Advertiser Device.
 The Advertiser Device then generates and sends a Seed Report which incorporates
 the 16-digit PIN code (the Seed Report Challenge), thereby allowing the
 health authority (the Publisher) to link the Seed Report to the diagnosis
 already recorded in its database.
\end_layout

\begin_layout Subsection
Seed Report Algorithms
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Report-Algorithms"

\end_inset


\end_layout

\begin_layout Standard
An Advertiser SHALL use the construction algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Construction"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to construct a Seed Report for uploading to a Publisher.
\end_layout

\begin_layout Standard
A Publisher SHALL use the verification algorithm defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Verification"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to verify a Seed Report prior to inclusion in a Notification.
\end_layout

\begin_layout Standard
An Observer has no need for the algorithms defined in this section since
 Observers do not receive Seed Reports.
\end_layout

\begin_layout Subsubsection
Seed Report Construction Algorithm
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Report-Construction"

\end_inset


\end_layout

\begin_layout Standard
The algorithm comprises 3 steps:
\end_layout

\begin_layout Enumerate
Construct a 
\series bold
TBSSeedReport
\series default
 data object as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:TBSSeedReport-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Compute the 
\series bold
signatureValue
\series default
 as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:SeedReport-signatureValue"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Construct a 
\series bold
SeedReport
\series default
 data object incorporating both the 
\series bold
tbsSeedReport
\series default
 and 
\series bold
signatureValue
\series default
 as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SeedReport-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Seed Report Verification Algorithm
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Report-Verification"

\end_inset


\end_layout

\begin_layout Standard
The algorithm comprises 4 steps:
\end_layout

\begin_layout Enumerate
Extract the 
\series bold
tbsSeedReport
\series default
 and 
\series bold
signatureValue
\series default
 fields from the 
\series bold
SeedReport
\series default
 data object as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SeedReport-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\begin_layout Enumerate
Extract the 
\series bold
signatureAlgorithm
\series default
 and 
\series bold
preseedVerificationKey
\series default
 fields from the 
\series bold
tbsSeedReport
\series default
 field as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:TBSSeedReport-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Verify that the 
\series bold
signatureAlgorithm
\series default
 is compatible as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSSeedReport-signatureAlgorithm"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Enumerate
Verify that the 
\series bold
signatureValue
\series default
 is correct as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:SeedReport-signatureValue"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Seed Report Layout
\begin_inset CommandInset label
LatexCommand label
name "subsec:Seed-Report-Layout"

\end_inset


\end_layout

\begin_layout Standard
A Seed Report is the ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoding of a 
\series bold
SeedReport
\series default
 data object as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SeedReport-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 A full ASN.1
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 schema is provided in Appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:ASN.1-Schema"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
TBSSeedReport fields
\begin_inset CommandInset label
LatexCommand label
name "subsec:TBSSeedReport-fields"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
TBSSeedReport
\series default
 data object is defined by the ASN.1
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 schema fragment:
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-tbsseedreport.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Paragraph
seedReportVersion
\begin_inset CommandInset label
LatexCommand label
name "par:TBSSeedReport-seedReportVersion"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-seedreportversion.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
seedReportVersion
\series default
 field describes the version of the 
\series bold
TBSSeedReport
\series default
 and 
\series bold
SeedReport
\series default
 structures.
 In the present specification, only a single version is defined.
\end_layout

\begin_layout Standard
An Advertiser SHALL set this field to version 1.
\end_layout

\begin_layout Standard
A Publisher SHALL accept any value in this field, and SHALL silently accept
 and ignore any unrecognised additional fields present in the 
\series bold
TBSSeedReport
\series default
 structure following the 
\series bold
seedReportChallenge
\series default
 field.
\end_layout

\begin_layout Paragraph
signatureAlgorithm
\begin_inset CommandInset label
LatexCommand label
name "par:TBSSeedReport-signatureAlgorithm"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
signatureAlgorithm
\series default
 field contains the X.509
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5280"
literal "false"

\end_inset

 
\series bold
AlgorithmIdentifier
\series default
 which comprises the object identifier (OID) and optional parameters for
 the algorithm used to generate the signature in the 
\series bold
signatureValue
\series default
 field (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:SeedReport-signatureValue"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
An Advertiser SHALL set this field to the algorithm used to compute the
 
\series bold
signatureValue
\series default
 field, and the algorithm SHALL be compatible with the Preseed Key Pair.
\end_layout

\begin_layout Standard
A Publisher SHALL verify that the algorithm specified in this field is compatibl
e with the public key algorithm provided in the 
\series bold
preseedVerificationKey
\series default
 field.
\end_layout

\begin_layout Paragraph
generatorType
\begin_inset CommandInset label
LatexCommand label
name "par:TBSSeedReport-generatorType"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-generatortype.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
generatorType
\series default
 field contains the Generator Type as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
preseedValues
\begin_inset CommandInset label
LatexCommand label
name "par:TBSSeedReport-preseedValues"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-preseedvalue-preseedvalues.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
preseedValues
\series default
 field contains an arbitrarily ordered sequence of Preseed Values, each
 encoded as an OCTET STRING of the Seed Length specified for the Generator
 Type in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
preseedVerificationKey
\begin_inset CommandInset label
LatexCommand label
name "par:TBSSeedReport-preseedVerificationKey"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
preseedVerificationKey
\series default
 field contains the X.509
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5280"
literal "false"

\end_inset

 
\series bold
SubjectPublicKeyInfo
\series default
 which comprises the algorithm object identifier (OID), optional algorithm
 parameters, and the public key of the Preseed Verification Key.
\end_layout

\begin_layout Standard
An Advertiser SHALL set this field to the same ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoded value as used for Seed Calculator instantiation as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Calculator-Instantiation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
A Publisher SHALL verify that the algorithm specified in this field is compatibl
e with the signature algorithm specified in the 
\series bold
signatureAlgorithm
\series default
 field.
\end_layout

\begin_layout Paragraph
publisherName
\begin_inset CommandInset label
LatexCommand label
name "par:TBSSeedReport-publisherName"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
publisherName
\series default
 field contains the Publisher Name for the Publisher to which the Advertiser
 intends to upload the Seed Report.
 This field exists solely to create a namespace for Seed Report Challenges,
 and thereby to reduce the scope for collision attacks on Seed Report Challenge
 values, which are necessarily low-entropy since they must be communicated
 accurately by humans.
\end_layout

\begin_layout Standard
An Advertiser SHALL set this field to the Publisher Name of the intended
 Publisher.
\end_layout

\begin_layout Standard
A Publisher SHALL verify that this field contains its own Publisher Name.
 Since this is a human-writable text field, a Publisher MAY choose to allow
 for some expected variations in the Publisher Name, such as variations
 in casing, punctuation, or whitespace.
\end_layout

\begin_layout Paragraph
seedReportChallenge
\begin_inset CommandInset label
LatexCommand label
name "par:TBSSeedReport-seedReportChallenge"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
seedReportChallenge
\series default
 field contains a Seed Report Challenge generated by the Publisher and conveyed
 to the Advertiser via an out-of-band mechanism; see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Seed-Report-Challenges"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
An Advertiser SHALL set this field to the Seed Report Challenge value provided
 via the out-of-band mechanism (such as interactive entry via a user interface
 on the Advertiser Device).
\end_layout

\begin_layout Standard
A Publisher SHALL verify that this field contains a recognised Seed Report
 Challenge value that is either:
\end_layout

\begin_layout Itemize
Unused and recently created, or
\end_layout

\begin_layout Itemize
Already used and associated with a Preseed Verification Key that matches
 the preseedVerificationKey field.
\end_layout

\begin_layout Standard
Since this is a human-writable text field, a Publisher MAY choose to allow
 for some expected variations in the Seed Report Challenge, such as variations
 in casing, punctuation, or whitespace.
\end_layout

\begin_layout Paragraph
extensions
\begin_inset CommandInset label
LatexCommand label
name "par:TSSeedReport-extensions"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-extension-extensions.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
extensions
\series default
 field contains OPTIONAL extensions defined outside the scope of this specificat
ion document.
 This field exists to support additional information that is not applicable
 to all Advertisers and Publishers.
 The layout of each extension comprises an extension identifier 
\series bold
extnID
\series default
 followed by fields as defined by that extension identifier.
\end_layout

\begin_layout Standard
An Advertiser MAY choose to include an 
\series bold
extensions
\series default
 field.
\end_layout

\begin_layout Standard
A Publisher MAY choose to interpret the contents of the 
\series bold
extensions
\series default
 field, and MAY choose to document extensions that should be included in
 Seed Reports uploaded to that Publisher.
 A Publisher SHALL silently accept and ignore any extension that it does
 not recognise.
 A Publisher SHALL accept and process a Seed Report that omits a particular
 extension, or that omits the 
\series bold
extensions
\series default
 field entirely.
 A Publisher SHALL NOT require that Advertisers include any particular extension
 in a Seed Report.
\end_layout

\begin_layout Subsubsection
SeedReport fields
\begin_inset CommandInset label
LatexCommand label
name "subsec:SeedReport-fields"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
SeedReport
\series default
 data object is defined by the ASN.1
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 schema fragment:
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx-seedreport.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\begin_layout Paragraph
tbsSeedReport
\begin_inset CommandInset label
LatexCommand label
name "par:SeedReport-tbsSeedReport"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
tbsSeedReport
\series default
 field contains the Generator Type, Preseed Values, Preseed Verification
 Key, Seed Report Challenge, and other information.
 It exists as a separate field since the 
\series bold
signatureValue
\series default
 is calculated over the ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoding of this field.
 The layout of this field is defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:TBSSeedReport-fields"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Paragraph
signatureValue
\begin_inset CommandInset label
LatexCommand label
name "par:SeedReport-signatureValue"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
signatureValue
\series default
 field contains a digital signature computed upon the encoded 
\series bold
tbsSeedReport
\series default
.
\end_layout

\begin_layout Standard
An Advertiser SHALL compute the 
\series bold
signatureValue
\series default
 using the algorithm specified by the 
\series bold
signatureAlgorithm
\series default
 field within 
\series bold
tbsSeedReport
\series default
 (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSSeedReport-signatureAlgorithm"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with the input data being the ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoding of 
\series bold
tbsSeedReport
\series default
 (including the initial SEQUENCE tag byte) and the signing key being the
 Preseed Signing Key.
\end_layout

\begin_layout Standard
A Publisher SHALL verify the 
\series bold
signatureValue
\series default
 using the algorithm specified by the 
\series bold
signatureAlgorithm
\series default
 field within 
\series bold
tbsSeedReport
\series default
 (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSSeedReport-signatureAlgorithm"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with the input data being the ASN.1
\begin_inset space ~
\end_inset

DER
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 encoding of 
\series bold
tbsSeedReport
\series default
 (including the initial SEQUENCE tag byte) and the verification key being
 the Preseed Verification Key extracted from the 
\series bold
preseedVerificationKey
\series default
 field within 
\series bold
tbsSeedReport
\series default
 (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "par:TBSSeedReport-preseedVerificationKey"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 A Publisher SHALL reject a Seed Report that fails signature verification
 and, where possible, SHALL return an error to the Advertiser indicating
 that the signature was incorrect.
\end_layout

\begin_layout Standard
\start_of_appendix
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "cx"
options "plain"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Part*
Appendix
\end_layout

\begin_layout Section
Generator Sample Code
\begin_inset CommandInset label
LatexCommand label
name "sec:Generator-Sample-Code"

\end_inset


\end_layout

\begin_layout Standard
This sample code is provided as a reference implementation showing the correct
 sequence of calls to standard OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library functions in order to produce the REQUIRED sequence of Contact
 Identifiers for a given Generator Type and Seed Value.
\end_layout

\begin_layout Standard
All input validity checks and error handling are omitted from this sample
 code in the interests of brevity.
 This sample code MUST NOT be used verbatim.
 A more complete reference implementation is available from 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://github.com/ipxe/cx
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "gen_sample.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
Generator Test Vectors
\begin_inset CommandInset label
LatexCommand label
name "sec:Generator-Test-Vectors"

\end_inset


\end_layout

\begin_layout Standard
Each test vector input comprises a Generator Type and a Seed Value.
\end_layout

\begin_layout Standard
Each test vector output comprises a pair of Contact Identifiers: the first
 and last Contact Identifiers that MUST be generated by iterating over the
 Generator.
\end_layout

\begin_layout Subsection
Generator Type 1, natural number seed
\end_layout

\begin_layout Standard
This test vector uses Generator Type 1 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a seed constructed from the first 24 natural numbers.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "gen_type1_test1.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 1, random seed
\end_layout

\begin_layout Standard
This test vector uses Generator Type 1 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a seed constructed from 24 randomly chosen bytes.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "gen_type1_test2.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 2, natural number seed
\end_layout

\begin_layout Standard
This test vector uses Generator Type 2 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a seed constructed from the first 48 natural numbers.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "gen_type2_test1.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 2, random seed
\end_layout

\begin_layout Standard
This test vector uses Generator Type 2 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a seed constructed from 48 randomly chosen bytes.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "gen_type2_test2.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
Seed Calculator Sample Code
\begin_inset CommandInset label
LatexCommand label
name "sec:Seed-Calculator-Sample"

\end_inset


\end_layout

\begin_layout Standard
This sample code is provided as a reference implementation showing the correct
 sequence of calls to standard OpenSSL
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "OpenSSL"
literal "false"

\end_inset

 library functions in order to produce the REQUIRED Seed Value for a given
 Generator Type, Preseed Value, and Preseed Verification Key.
\end_layout

\begin_layout Standard
All input validity checks and error handling are omitted from this sample
 code in the interests of brevity.
 This sample code MUST NOT be used verbatim.
 A more complete reference implementation is available from 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://github.com/ipxe/cx
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "seedcalc_sample.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
Seed Calculator Test Vectors
\begin_inset CommandInset label
LatexCommand label
name "sec:Seed-Calculator-Test"

\end_inset


\end_layout

\begin_layout Standard
Each test vector input comprises a Preseed Value and a Preseed Verification
 Key (shown in PEM form).
\end_layout

\begin_layout Standard
Each test vector output comprises a Seed Value that MUST be constructed
 by using the Seed Calculator.
\end_layout

\begin_layout Subsection
Generator Type 1, natural number preseed, public key 
\begin_inset Quotes eld
\end_inset

A
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This test vector uses Generator Type 1 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a preseed constructed from the first 24 natural numbers and public
 key 
\begin_inset Quotes eld
\end_inset

A
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "fensystems.pubkey.pem"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "seedcalc_type1_test1.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 1, natural number preseed, public key 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This test vector uses Generator Type 1 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a preseed constructed from the first 24 natural numbers and public
 key 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "ipxe.pubkey.pem"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "seedcalc_type1_test2.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 1, random preseed, public key 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This test vector uses Generator Type 1 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a preseed constructed from 24 randomly chosen bytes and public key
 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "ipxe.pubkey.pem"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "seedcalc_type1_test3.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 2, natural number preseed, public key 
\begin_inset Quotes eld
\end_inset

A
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This test vector uses Generator Type 2 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a preseed constructed from the first 48 natural numbers and public
 key 
\begin_inset Quotes eld
\end_inset

A
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "fensystems.pubkey.pem"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "seedcalc_type2_test1.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 2, natural number preseed, public key 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This test vector uses Generator Type 2 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a preseed constructed from the first 48 natural numbers and public
 key 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "ipxe.pubkey.pem"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "seedcalc_type2_test2.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Subsection
Generator Type 2, random preseed, public key 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
This test vector uses Generator Type 2 (as defined in section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Generator-Types"
plural "false"
caps "false"
noprefix "false"

\end_inset

) with a preseed constructed from 48 randomly chosen bytes and public key
 
\begin_inset Quotes eld
\end_inset

B
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "ipxe.pubkey.pem"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "seedcalc_type2_test3.c"
lstparams "language=C"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Section
ASN.1 Schema
\begin_inset CommandInset label
LatexCommand label
name "sec:ASN.1-Schema"

\end_inset


\end_layout

\begin_layout Standard
This schema includes all ASN.1
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "X.690"
literal "false"

\end_inset

 data objects defined by this specification.
 The imported definitions for AlgorithmIdentifier and SubjectPublicKeyInfo
 may be found in RFC
\begin_inset space ~
\end_inset

5280
\begin_inset space ~
\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "RFC5280"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand inputminted
filename "cx.asn1"
lstparams "language=Clean"

\end_inset


\end_layout

\end_body
\end_document
